%%Training data

X = [1:601];

Y = [1254.163177
1269.791782
1273.021903
1272.63291
1278.63947
1291.05638
1318.137442
1348.836654
1347.650791
1366.447889
1364.816358
1437.838769
1476.216137
1499.702235
1558.649136
1561.862095
1556.108352
1565.51278
1629.142366
1722.642145
1741.792273
1823.969795
1757.43257
1701.255062
1793.371754
1726.024204
1725.931197
1806.76941
1859.236629
1939.303498
1995.803111
2044.254598
2141.814836
2206.785612
2370.000403
2504.192603
2304.733529
2000.574938
2134.053987
2212.826468
2232.638647
2218.471614
2364.130792
2405.987018
2496.862451
2506.109898
2602.62209
2802.77469
2774.216577
2734.200409
2822.54044
2853.437828
2908.925603
2684.666897
2693.861992
2573.604888
2307.053259
2445.520758
2571.161945
2556.831592
2570.875671
2695.637386
2699.517161
2686.145948
2727.583361
2621.852894
2537.345867
2423.699988
2395.504489
2533.803584
2545.453022
2518.833235
2422.522953
2447.552378
2544.34947
2608.409749
2588.711589
2602.557371
2533.703136
2512.869298
2540.897302
2401.261778
2332.388697
2347.411182
2366.324265
2252.438534
2064.927159
1920.909071
2082.489904
2296.009715
2317.531648
2601.755432
2731.023814
2805.106715
2770.672875
2759.299295
2597.421794
2512.604229
2599.193451
2760.737067
2731.853215
2695.114239
2796.860959
2770.196239
2719.883553
2768.121268
2847.57345
3160.152236
3239.090559
3336.91263
3424.042782
3338.65101
3408.779852
3537.513542
3799.002856
4028.814601
4210.865311
4125.310594
4189.15835
4347.746432
4182.160687
4068.812263
4107.481733
4028.634527
3900.099279
4162.89495
4220.292967
4370.024576
4319.863873
4355.555545
4309.214405
4518.469296
4578.047844
4688.952905
4814.497913
4650.817965
4572.265079
4326.404374
4253.793209
4549.825154
4607.035392
4362.399238
4309.336021
4175.280078
4227.843445
4235.743555
3904.705624
3521.048649
3386.796233
3705.439599
3656.266308
3967.75669
3967.84956
3952.189736
3745.536524
3614.208885
3735.912404
3702.08659
3859.235685
3928.424245
4084.819109
4195.134057
4136.846434
4308.506219
4332.592827
4418.755447
4312.418481
4251.192231
4274.505266
4374.540578
4386.142188
4526.800583
4706.221059
4830.357117
4803.06894
5177.295099
5634.244377
5699.046564
5619.670949
5690.36252
5616.586212
5365.684688
5656.112141
5889.592438
6064.866964
5892.484212
5841.811133
5648.913306
5534.214453
5846.398058
5817.507003
5741.098681
5930.430598
6125.338371
6299.665787
6530.415317
6964.809781
7237.404189
7254.712803
7465.323542
7189.782813
7093.883512
7413.109602
7225.405503
6817.176677
6469.959714
6037.6832
6365.65196
6576.075104
7039.031799
7541.790019
7819.541093
7678.204265
7889.833794
8154.883028
8127.419904
8200.632097
8167.31994
8161.016856
8485.652539
9110.279874
9589.792931
9860.745261
10366.60899
9818.839648
10261.38113
10946.94683
11299.93166
11353.60038
11694.41333
12720.95354
15180.38995
15852.9178
14836.13053
14403.51435
16492.56442
16907.76733
16576.15255
16436.67757
17457.4106
18531.98535
19288.6604
18653.38687
17970.94477
16654.1504
15997.161
13374.71302
14643.66273
13312.54122
13843.91291
15360.13646
15592.99782
14239.36552
14583.2946
13112.37884
13410.03962
13484.45894
14207.16044
15056.84201
14929.55171
16088.91382
16832.33199
16575.02617
15207.48571
14908.17844
14230.69776
13683.84583
13738.80592
14324.53653
13645.39067
13919.19346
11798.03139
10518.19382
11503.38953
11407.00524
12534.9437
11905.10915
10933.85632
10764.7511
11108.65232
11370.44279
10959.79014
11346.4114
11808.30297
11408.67342
10488.59234
10067.87208
9402.26054
8582.741224
9003.231388
8585.234682
7413.509653
6851.605861
7956.391186
8260.833234
8307.091104
8668.238324
8222.405482
8692.661498
8651.479635
9131.190478
9874.986878
10059.31409
10738.44423
10747.20654
10961.6466
11515.28771
10818.32895
10232.97875
10040.9733
9934.442784
9621.36192
10064.42515
10632.60787
10680.29514
10770.61902
11048.68289
11394.60464
11320.35729
11584.18098
11013.09771
10154.42097
9634.837327
8911.121183
9240.537644
9172.912389
9384.192451
9184.199268
8564.809665
8111.678837
8349.185878
8078.90325
7724.083074
8425.867238
8718.288903
9013.723816
8781.843428
8572.754344
8871.345355
8565.78363
8183.216899
7987.72939
7963.520735
7422.693137
6894.755398
7067.285319
6775.243764
7030.690041
7371.946641
7079.311161
6791.63363
6673.905163
6947.040933
7051.699901
6909.184256
6843.029749
6946.379067
7556.690998
8041.971165
8057.849747
8289.896026
8137.063378
8075.231892
8124.569701
8268.20835
8541.694418
8854.2882
8945.283364
8948.765395
9361.536924
9231.48409
8930.298835
9243.263762
9287.806111
9394.105406
9315.050296
9030.01083
9154.853819
9462.960968
9665.018119
9870.997795
9675.783147
9379.16004
9275.148464
9206.700913
9273.966324
8735.340879
8447.44252
8603.605517
8627.200606
8645.986276
8294.450448
8268.293991
8128.772336
8296.504049
8429.51564
8491.390951
8228.405782
7746.026067
7531.486588
7496.988759
7517.698201
7349.287647
7266.40521
7336.185827
7461.485742
7539.000046
7509.344523
7640.082532
7730.21569
7602.613238
7536.815426
7630.618709
7727.613696
7657.080819
7646.647793
7007.296042
6783.62382
6702.508291
6412.393737
6526.778806
6568.842427
6493.551506
6535.96779
6590.149847
6747.918793
6711.91887
6756.191081
6282.114475
6151.332658
6022.382476
6231.591942
6220.02046
6121.619409
6069.103558
5972.967874
6394.342968
6363.916149
6376.362749
6519.899905
6610.494663
6604.642203
6575.578445
6633.175464
6767.024629
6733.111514
6487.528189
6417.978108
6240.192379
6275.011758
6293.640296
6385.319065
6607.949594
7092.726822
7451.052956
7445.83902
7456.382525
7381.428751
7488.77553
7707.998125
8112.358928
8184.748915
8151.94244
8044.36555
8187.716789
8224.397015
8116.429985
7876.166042
7588.005605
7612.277074
7418.273101
7187.076361
7019.445471
7010.131768
6962.546441
6432.062317
6426.615294
6340.23942
6226.075543
6327.416489
6365.681875
6069.234683
6410.341291
6371.809007
6501.357678
6464.191397
6437.665274
6420.784635
6424.635859
6580.769337
6462.069552
6589.866261
6763.624484
6698.616386
6764.593515
7023.810214
7071.589212
6944.627922
7014.274267
7171.599431
7284.62169
7286.662678
7363.92481
7037.554684
6452.971221
6478.881431
6383.465196
6315.091197
6320.736115
6313.331471
6296.28527
6471.704521
6513.793897
6532.425543
6490.6657
6370.498504
6327.254784
6345.353115
6444.587288
6678.46772
6725.732232
6724.512669
6634.647079
6428.070947
6487.998475
6568.016065
6688.872912
6570.494491
6618.615435
6601.07544
6576.530191
6493.140902
6587.435207
6608.45422
6564.654841
6577.238657
6639.740536
6644.361481
6569.957797
6281.734157
6274.151488
6283.640344
6311.815324
6713.985069
6591.25183
6572.097978
6540.346731
6498.836748
6507.750446
6572.239757
6490.819798
6483.791895
6510.035918
6475.354468
6472.904729
6498.055626
6492.527755
6370.166487
6313.453201
6319.827251
6365.471254
6409.467289
6371.941229
6435.738193
6451.781224
6452.987761
6534.481187
6493.534205
6414.624929
6434.071925
6399.9513
6407.355434
6366.936793
5859.505513
5550.31357
5590.310245
5562.140545
5597.068692
5154.910569
4550.143598
4506.547297
4501.593524
4287.13103
4086.644414
3832.473567
3846.217661
3751.450784
4142.875982
4277.975528
4080.23747
4145.028568
4177.841952
3947.700109
3944.431545
3829.357835
3704.297876
3396.262664
3434.957005
3543.243302
3507.648898
3416.362103];

YY1 = polyfit(X, Y', 4);
YY2 = polyfit(X, Y', 5);
YY3 = polyfit(X, Y', 6);

Y1 = YY1(1)*(X.^4) + YY1(2)*(X.^3) + YY1(3)*(X.^2) + YY1(4)*X + YY1(5);
Y2 = YY2(1)*(X.^5) + YY2(2)*(X.^4) + YY2(3)*(X.^3) + YY2(4)*(X.^2) + YY2(5)*X + YY2(6);
Y3 = YY3(1)*(X.^6) + YY3(2)*(X.^5) + YY3(3)*(X.^4) + YY3(4)*(X.^3) + YY3(5)*(X.^2) + YY3(6)*X + YY3(7);

hold on;
plot(X, Y);
plot(X, Y1, 'r');
plot(X, Y2, 'g');
plot(X, Y3, 'y');
hold off; 

%%Testing data

X1 =[602:1003];

TY = [3457.506526
3383.730606
3264.605222
3222.666508
3285.463612
3441.961557
3578.313793
3807.570277
4026.394011
4020.422188
3927.688081
4048.372036
4180.326643
3837.659772
3819.899147
3744.259125
3808.094635
3928.38885
3854.815805
3802.744331
3782.307802
3902.20519
3871.609882
3840.356656
3898.562213
4013.2829
4060.620364
4063.617141
4056.566326
3809.877998
3669.96714
3666.214404
3592.71543
3650.500293
3666.950992
3644.10585
3644.060111
3649.645007
3735.868153
3610.455304
3573.294238
3570.932562
3583.825218
3577.401449
3570.250537
3627.501894
3570.481088
3455.768149
3414.528886
3453.390657
3446.312879
3441.837632
3473.509199
3453.748473
3434.149993
3435.99671
3396.623936
3380.296373
3544.365745
3639.793605
3639.890488
3617.112194
3605.141594
3610.609064
3593.87408
3597.076562
3623.367288
3642.355711
3810.464185
3941.001444
3945.078885
3948.954172
3962.311364
4055.51743
3968.960298
3822.562861
3815.252208
3804.930869
3847.427216
3837.328256
3831.960394
3820.249232
3748.786892
3815.383285
3862.025303
3886.340675
3890.740462
3926.456767
3921.644051
3882.735511
3871.346283
3878.097947
3875.973932
3908.395197
4022.677755
4000.688824
3991.275407
4005.87301
4028.277965
4024.201569
4001.744717
4008.067508
3995.478939
3989.226616
3929.342079
4012.823902
4036.452529
4084.646572
4111.437599
4112.849682
4139.229231
4723.908445
5062.193297
4964.915198
5001.21408
5091.084181
5155.247176
5251.564837
5222.777428
5312.621127
5124.916933
5042.338188
5096.174356
5103.009518
5095.408329
5135.286953
5230.250439
5274.746345
5270.64788
5323.270145
5288.500499
5347.653854
5546.472989
5500.1885
5297.079372
5225.346025
5228.893124
5280.307174
5233.808633
5297.932238
5375.494553
5479.056475
5731.239955
5772.514926
5794.894989
5726.639401
5927.842957
5905.078874
6084.402262
6314.591905
6899.461864
7160.663832
7648.79923
7975.729004
8056.890613
7993.39919
7237.353388
7339.292835
7926.179209
7903.741114
7950.313684
7829.719499
7716.641348
8006.386053
8038.087255
8389.809348
8790.876037
8704.332691
8633.05337
8567.429815
8347.681486
8545.443781
8692.34165
8426.596789
7814.5603
7775.952315
7705.042653
7968.695463
7927.395618
7740.541422
7867.470963
7883.6391
8068.397394
8189.536783
8417.992998
8748.16938
9099.928609
9257.992479
9126.461429
9154.825065
9401.754648
9836.263828
10711.51015
10846.86537
10849.24239
11339.99445
12702.1702
11584.46127
11668.8276
11829.19013
11337.86571
10585.19109
10244.43558
11366.62494
11684.35208
11116.40679
11412.58172
11348.53603
11935.25304
12484.90709
12487.28527
11514.93926
11566.95004
11291.5961
10675.73741
10407.04673
10041.91871
9553.96369
10091.87402
10448.25009
10727.34064
10561.38933
10369.80751
10035.97686
9709.668235
10017.89138
9784.545583
9657.091258
9438.723514
9541.660359
9578.61459
9905.853996
10160.5844
10487.57849
10777.27095
10847.98911
11651.29518
11766.99216
11774.20576
11799.65687
11832.90553
11501.29901
11378.29013
11391.90014
11047.25992
10384.86438
9983.391878
10183.8758
10257.87642
10338.4207
10671.05911
10754.02965
10175.62306
10009.47788
10311.5097
10109.38672
10100.5084
10389.90534
10176.46775
9908.091539
9512.789907
9557.433736
9614.059623
9685.968341
10098.22872
10567.11407
10580.15669
10569.25861
10622.86028
10466.12671
10445.95454
10304.81532
10168.3655
10074.61596
10285.8605
10323.00022
10376.2361
10354.28033
10248.84597
10237.98249
10197.67408
10002.30559
10187.71753
10043.07268
10000.76107
9845.976775
8906.12219
8456.347132
8119.608702
8068.432
8193.59192
8081.436375
8073.951665
8389.500198
8284.183156
8236.516137
8165.780699
8156.157046
7980.729952
8101.234876
8230.432155
8454.821686
8574.596015
8465.807239
8390.422967
8364.966312
8340.036992
8260.320081
8054.158123
8088.504037
7971.355254
8011.146016
8122.306438
8256.588545
8202.975955
7612.346273
7475.919143
8230.05248
9427.016422
9505.127416
9512.128849
9380.117815
9187.356451
9188.389712
9185.352539
9328.458233
9231.652297
9373.971736
9350.291328
9355.284246
9233.606803
8905.487857
8826.349682
8969.251662
8777.945986
8737.790257
8775.304685
8664.908079
8549.623452
8508.429174
8552.413498
8331.879099
8121.290123
8124.007168
7744.195276
7232.739223
7265.963833
7112.582866
6951.686135
7160.556638
7316.990575
7540.168573
7659.869003
7649.097671
7375.141799
7312.602092
7342.582885
7350.73405
7349.205233
7449.505253
7561.600878
7523.959598
7471.171911
7298.915517
7235.772202
7201.406319
7251.040683
7155.360906
7121.079477
7022.369851
6751.758665
6866.122232
7170.929914
7172.787033
7178.247676
7340.704042
7514.362558
7310.332413
7228.333226
7270.363514
7202.556171
7328.851035
7419.142213
7302.378657
7227.302109
7242.77191
7063.122165
7247.529926
7340.610918
7438.41471
7585.238041
7955.776161
8215.115068
7895.977111
7943.438458
8136.103278
8113.702509
8108.56703
8587.403972
8754.613994
8675.947364
8690.202584];

TY1 = YY1(1)*(X1.^4) + YY1(2)*(X1.^3) + YY1(3)*(X1.^2) + YY1(4)*X1 + YY1(5);
TY2 = YY2(1)*(X1.^5) + YY2(2)*(X1.^4) + YY2(3)*(X1.^3) + YY2(4)*(X1.^2) + YY2(5)*X1 + YY2(6);
TY3 = YY3(1)*(X1.^6) + YY3(2)*(X1.^5) + YY3(3)*(X1.^4) + YY3(4)*(X1.^3) + YY3(5)*(X1.^2) + YY3(6)*X1 + YY3(7);

diff1 = TY - TY1';
diff2 = TY - TY2';
diff3 = TY - TY3';

sd1 = std(diff1);
sd2 = std(diff2);
sd3 = std(diff3);

V1 = var(diff1);
V2 = var(diff2);
V3 = var(diff3);

%%Forecasting Data

X2 = [1004:1035];

FY1 = YY1(1)*(X2.^4) + YY1(2)*(X2.^3) + YY1(3)*(X2.^2) + YY1(4)*X2 + YY1(5);
FY2 = YY2(1)*(X2.^5) + YY2(2)*(X2.^4) + YY2(3)*(X2.^3) + YY2(4)*(X2.^2) + YY2(5)*X2 + YY2(6);
FY3 = YY3(1)*(X2.^6) + YY3(2)*(X2.^5) + YY3(3)*(X2.^4) + YY3(4)*(X2.^3) + YY3(5)*(X2.^2) + YY3(6)*X2 + YY3(7);

